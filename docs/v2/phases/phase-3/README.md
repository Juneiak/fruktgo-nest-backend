# Фаза 3: Engagement

> Удержание клиентов: лояльность, маркетинг, отзывы, поддержка.

**Длительность:** 2-3 недели

**Зависимости:** Требует Фазы 1 (CUSTOMER) и Фазы 2 (FINANCE)

---

## Цели

1. Клиент получает баллы и карточку лояльности
2. Работают промокоды и акции
3. Клиент может оставить отзыв
4. Клиент может обратиться в поддержку

---

## Этапы

| Этап | Название | Модули | Что делаем |
|------|----------|--------|------------|
| 1 | Лояльность | LOYALTY | MemberCard, баллы, тиры, QR |
| 2 | Маркетинг | MARKETING | Промокоды, акции, баннеры |
| 3 | Отзывы | REPUTATION | Отзывы, рейтинги, модерация |
| 4 | Поддержка | SUPPORT | Тикеты (Issue), Telegram чат |

---

## Этап 1: Лояльность (LOYALTY)

**Сущности:** MemberCard

**Задачи:**
- MemberCard: barcode, balance, tier
- Начисление баллов (за недовес, кэшбэк)
- Списание при оплате
- QR endpoint для показа карточки
- Лимиты (антиабьюз)

**Детали:** [stage-1.md](./stage-1.md) *(после утверждения)*

---

## Этап 2: Маркетинг (MARKETING)

**Сущности:** Promo, Campaign, Banner

**Задачи:**
- Промокоды: типы скидок, условия, лимиты
- Акции: "2 по цене 1", happy hours
- Баннеры: главная, категории
- Anti-abuse: лимит на клиента/IP

**Детали:** [stage-2.md](./stage-2.md) *(после утверждения)*

---

## Этап 3: Отзывы (REPUTATION)

**Сущности:** ProductReview, ShopReview

**Задачи:**
- Отзывы на товары и магазины
- Рейтинги (агрегация)
- Проверка покупки перед отзывом
- Модерация
- Баллы за отзывы (→ LOYALTY)

**Детали:** [stage-3.md](./stage-3.md) *(после утверждения)*

---

## Этап 4: Поддержка (SUPPORT)

**Сущности:** Issue, Dispute

**Задачи:**
- Тикеты (Issue) → связка с Telegram
- Споры (Dispute) по заказам
- SLA и эскалация
- FAQ (база знаний)

**Детали:** [stage-4.md](./stage-4.md) *(после утверждения)*

---

## Ключевые требования

- **Observability:** Prometheus метрики
- **Anti-abuse:** лимиты на промо и отзывы
- **Feature flags:** для поэтапного включения

---

## Критерии готовности

- [ ] MemberCard с QR работает
- [ ] Промокоды применяются при checkout
- [ ] Отзывы с проверкой покупки
- [ ] Тикеты создаются и видны в Telegram
