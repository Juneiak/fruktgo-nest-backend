# Фаза 0: Фундамент

> Подготовка инфраструктуры до написания бизнес-логики.

**Длительность:** ~1 неделя

---

## Цель

Создать технический фундамент для разработки модулей:
- Распределённая шина событий
- Структура проекта по новой архитектуре
- Правила изоляции модулей

---

## Этапы

| Этап | Название | Что делаем |
|------|----------|------------|
| 1 | Redis + BullMQ | Настройка Redis, модуль очередей, EventBusPort |
| 2 | Структура проекта | Папки модулей, ESLint правила, barrel exports |
| 3 | Общие утилиты | Ошибки, декораторы, guards, базовые типы |

---

## Этап 1: Redis + BullMQ

**Задачи:**
- [ ] Добавить Redis в docker-compose
- [ ] Установить @nestjs/bullmq
- [ ] Создать `EventBusPort` интерфейс
- [ ] Реализовать BullMQ adapter (prod)
- [ ] Реализовать EventEmitter adapter (dev)
- [ ] Очереди по приоритету: high, default, low

**Детали:** [stage-1.md](./stage-1.md) *(после утверждения)*

---

## Этап 2: Структура проекта

**Задачи:**
- [ ] Создать папки модулей по архитектуре V2
- [ ] ESLint правило: запрет импорта схем между модулями
- [ ] Barrel exports (index.ts) для каждого модуля
- [ ] Шаблон модуля: port, service, schema, commands, queries

**Детали:** [stage-2.md](./stage-2.md) *(после утверждения)*

---

## Этап 3: Общие утилиты

**Задачи:**
- [ ] DomainError, handleServiceError
- [ ] Декораторы: @GetUser(), @UserType()
- [ ] Guards: JwtAuthGuard, TypeGuard
- [ ] Базовые типы: Pagination, city

**Детали:** [stage-3.md](./stage-3.md) *(после утверждения)*

---

## Критерии готовности

- [ ] Redis работает в docker-compose
- [ ] EventBusPort работает (emit/subscribe)
- [ ] Структура папок соответствует архитектуре V2
- [ ] ESLint блокирует неправильные импорты
